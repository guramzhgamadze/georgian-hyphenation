<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Georgian Hyphenation</title>
    
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />
    <link rel="stylesheet" href="taskpane.css" />
</head>
<body class="ms-Fabric">
    <header class="header">
        <h1 class="ms-font-xl">Georgian Hyphenation</h1>
        <div class="version-badge">Version 2.2.6</div>
    </header>

    <main class="content-main">
        <div class="buttons-container">
            <!-- Status Bar -->
            <div id="status">მზად არის სამუშაოდ</div>
            
            <!-- Progress Bar -->
            <div id="progress-container" class="progress-container">
                <div class="progress-header">
                    <span id="progress-label">მუშავდება...</span>
                    <span id="progress-percent">0%</span>
                </div>
                <div class="progress-track">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <button id="hyphenate-document" class="ms-Button">
                <span class="btn-icon">📄</span>
                <span class="ms-Button-label">მთლიანი დოკუმენტის დამარცვლა</span>
            </button>
            
            <button id="hyphenate-selection" class="ms-Button">
                <span class="btn-icon">✂️</span>
                <span class="ms-Button-label">მონიშნული ტექსტის დამარცვლა</span>
            </button>
            
            <button id="clear-highlighting" class="ms-Button ms-Button-secondary">
                <span class="btn-icon">🧹</span>
                <span class="ms-Button-label">მარკირების მოშორება</span>
            </button>
            
            <!-- Log Toggle -->
            <div class="log-toggle-container">
                <span class="log-toggle-label">აქტივობის ჟურნალი</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggle-log">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <!-- Error Log Container -->
            <div id="error-log-container" class="error-log-container">
                <div class="error-log-header">
                    <span class="error-log-title">აქტივობის ჟურნალი</span>
                    <div class="error-log-actions">
                        <button id="download-log" class="error-log-clear">ჩამოტვირთვა</button>
                        <button id="clear-log" class="error-log-clear">გასუფთავება</button>
                    </div>
                </div>
                <div id="error-log-content"></div>
            </div>
            
            <!-- Features Card (Collapsible) -->
            <div class="features-card" id="features-card">
                <div class="features-card-header" onclick="toggleFeatures()">
                    <div class="features-card-title">
                        <span>ℹ️</span>
                        <span>როგორ მუშაობს</span>
                    </div>
                    <div class="features-card-toggle">▼</div>
                </div>
                <div class="features-card-content">
                    <div class="features-card-body">
                        <strong>ძვე­ლი და­მარ­ცვლა</strong>
                        <p class="description-text">
                            პრო­გრა­მა შლის ძველ და­მარ­ცვლას (არ­სე­ბიობის შემ­თხვე­ვა­ში) და ავ­ტო­მა­ტუ­რად მარ­ცვლავს ქარ­თულ ტექ­სტს. გადატანის ნიშ­ნე­ბი გა­მო­ჩნდე­ბა რო­დე­საც გა­მო­ი­ყე­ნებთ Justify გას­წო­რე­ბას ან ჩარ­თავთ ¶ სიმ­ბო­ლოს ჩვე­ნე­ბას.
                        </p>
                        
                        <div class="info-divider"></div>
                        
                        <strong>შეც­დო­მის მა­ნიშ­ვნის ფუნ­ქცია</strong>
                        <p class="description-text">
                            პრობ­ლე­მუ­რი პა­რაგ­რა­ფე­ბი (რომ­ლე­ბიც ვერ და­მუ­შავ­და) ავ­ტო­მა­ტუ­რად მოინიშნება ყვით­ლად. ეს დაგ­ეხ­მა­რე­ბათ იხი­ლოთ რო­მე­ლი პა­რაგ­რა­ფი საჭი­რო­ებს ხელ­ით შეც­ვლას.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <script src="taskpane.js"></script>
    <script>
        // Toggle features card
        function toggleFeatures() {
            const card = document.getElementById('features-card');
            if (card) {
                card.classList.toggle('expanded');
            }
        }
        
        // Toggle log visibility (keeping compatibility with original JS)
        document.getElementById('toggle-log')?.addEventListener('change', function(e) {
            const container = document.getElementById('error-log-container');
            if (container) {
                if (e.target.checked) {
                    container.classList.add('visible');
                } else {
                    container.classList.remove('visible');
                }
            }
        });
    </script>
</body>
</html>